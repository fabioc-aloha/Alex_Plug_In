# yaml-language-server: $schema=https://aka.ms/teams-toolkit/v1.8/yaml.schema.json
# Local development configuration - Pure M365 (no API required)

version: v1.8

provision:
  # Creates a Teams app for local development
  - uses: teamsApp/create
    with:
      name: Alex Cognitive-local
    writeToEnvironmentFile:
      teamsAppId: TEAMS_APP_ID

  # Build Teams app package
  - uses: teamsApp/zipAppPackage
    with:
      manifestPath: ./appPackage/manifest.json
      outputZipPath: ./appPackage/build/appPackage.local.zip
      outputFolder: ./appPackage/build

  # Validate manifest
  - uses: teamsApp/validateManifest
    with:
      manifestPath: ./appPackage/build/manifest.local.json

  # Update Teams app
  - uses: teamsApp/update
    with:
      appPackagePath: ./appPackage/build/appPackage.local.zip

deploy:
  # Pure M365 - no API deployment needed!
  - uses: script
    with:
      run: echo "Pure M365 agent - no API to deploy. Just upload the package to Developer Portal."
